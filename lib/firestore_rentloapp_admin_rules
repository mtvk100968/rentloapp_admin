
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // This rule block allows read/write access only if a request is from an authenticated user.
    // Additionally, it ensures that the user can only modify documents that are in a "users" collection
    // named after their own UID. Adjust collection names and logic as necessary for your schema.

    match /users/{userId} {
      allow read: if request.auth != null;  // Authenticated users can read
      allow write: if request.auth != null
                   && request.auth.uid == userId; // Only the document owner can write
    }

    // If you have other collections that you want to protect differently, add more match blocks.
    // For example:
    // match /public/{docId} {
    //   // read: anyone can read
    //   allow read: if true;
    //   // only authenticated users can write
    //   allow write: if request.auth != null;
    // }

    // Deny all other requests by default.
    // (If no other match blocks handle the request, it will be denied.)
  }
}
